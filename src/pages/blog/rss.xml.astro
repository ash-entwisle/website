---
import rss from "@astrojs/rss";

const rawPosts = await Astro.glob("../posts/*.mdx");

// remove drafts and sort by date (date being a parsed int rather than date object)
const posts = rawPosts
  .filter((post) => !post.frontmatter.draft)
  .sort((a, b) => b.frontmatter.date - a.frontmatter.date);

return rss({
  title: "Ash's Blog",
  description:
    "Hi, I'm Ash! I'm a 2nd year Comp-Sci student who loves rust, linux, mechanical keyboards, toasters and blue ikea sharks :3",
  site: "https://ashentwisle.com",
  items: [
    ...posts.map((post) => ({
      title: post.frontmatter.title,
      pubDate: new Date(post.frontmatter.date).toUTCString(),
      description: post.frontmatter.description,
      link: `https://ashentwisle.com${post.url}`,
    })),
  ],
});
---
